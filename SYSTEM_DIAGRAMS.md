# ğŸ“Š System Architecture Diagrams

## IoT Pet Feeder - Visual Documentation

---

## ğŸ—ï¸ High-Level System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚                         ğŸŒ USER INTERFACE                            â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ğŸ“± Login    â”‚  â”‚  ğŸ“ Register â”‚  â”‚  ğŸ® Dashboardâ”‚              â”‚
â”‚  â”‚   Page       â”‚  â”‚     Page     â”‚  â”‚    (Main)    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                            â†“                          â”‚
â”‚                     React 19 + Vite + React Router                   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTP/REST API
                                â”‚ (Axios)
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚                        ğŸ–¥ï¸ BACKEND SERVER                               â”‚
â”‚                     (Node.js + Express.js)                             â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                    ğŸ” MIDDLEWARE LAYER                     â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚     CORS     â”‚  â”‚     JWT      â”‚  â”‚  Validator   â”‚    â”‚       â”‚
â”‚  â”‚  â”‚  Protection  â”‚  â”‚     Auth     â”‚  â”‚   Express    â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                     ğŸ“¡ API ROUTES                          â”‚       â”‚
â”‚  â”‚                                                             â”‚       â”‚
â”‚  â”‚  /api/auth/            /api/schedule/        /api/feeding/ â”‚       â”‚
â”‚  â”‚  â”œâ”€ register          â”œâ”€ create              â”œâ”€ activate  â”‚       â”‚
â”‚  â”‚  â””â”€ login             â”œâ”€ list                â”œâ”€ stop      â”‚       â”‚
â”‚  â”‚                       â”œâ”€ update/:id          â”œâ”€ logs      â”‚       â”‚
â”‚  â”‚                       â””â”€ delete/:id          â””â”€ status    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                   âš™ï¸ BUSINESS LOGIC                        â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚   MQTT       â”‚  â”‚    Cron      â”‚  â”‚   Mongoose   â”‚    â”‚       â”‚
â”‚  â”‚  â”‚ Controller   â”‚  â”‚  Scheduler   â”‚  â”‚     ODM      â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                           â”‚
             â”‚ MQTT Protocol             â”‚ MongoDB Protocol
             â”‚                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        â”‚   â”‚                                    â”‚
â”‚   ğŸ“¡ MQTT BROKER      â”‚   â”‚     ğŸ—„ï¸ MONGODB ATLAS             â”‚
â”‚   (HiveMQ/Mosquitto)   â”‚   â”‚      (Cloud Database)             â”‚
â”‚                        â”‚   â”‚                                    â”‚
â”‚  Topic: petfeeder/     â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  - servo               â”‚   â”‚  â”‚  Collections:            â”‚    â”‚
â”‚  - servo/response      â”‚   â”‚  â”‚  â”œâ”€ users                â”‚    â”‚
â”‚                        â”‚   â”‚  â”‚  â”œâ”€ feedingschedules     â”‚    â”‚
â”‚                        â”‚   â”‚  â”‚  â””â”€ feedinglogs          â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
             â”‚                â”‚                                    â”‚
             â”‚ Subscribe       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                             â”‚
â”‚      ğŸ¤– ESP32 / ARDUINO                    â”‚
â”‚      (Microcontroller)                     â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ“¶ WiFi Module (ESP32)        â”‚        â”‚
â”‚  â”‚  or                            â”‚        â”‚
â”‚  â”‚  ğŸ”Œ Serial Port (Arduino)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ“¡ MQTT Client                â”‚        â”‚
â”‚  â”‚  - Receives commands           â”‚        â”‚
â”‚  â”‚  - Sends responses             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ›ï¸ Servo Control Logic        â”‚        â”‚
â”‚  â”‚  - Angle calculation           â”‚        â”‚
â”‚  â”‚  - Duration timing             â”‚        â”‚
â”‚  â”‚  - Emergency stop              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ PWM Signal
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                             â”‚
â”‚         ğŸ”§ SERVO MOTOR                     â”‚
â”‚         (SG90 or similar)                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Rotation Angles:              â”‚        â”‚
â”‚  â”‚  â”œâ”€ 0Â° = Closed (default)      â”‚        â”‚
â”‚  â”‚  â”œâ”€ 45Â° = Small portion        â”‚        â”‚
â”‚  â”‚  â”œâ”€ 90Â° = Medium portion       â”‚        â”‚
â”‚  â”‚  â””â”€ 135Â° = Large portion       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                             â”‚
â”‚         â†“                                   â”‚
â”‚    ğŸ– Food Dispensed                        â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

### 1. User Registration Flow

```
User Form Input
      â†“
Frontend Validation
      â†“
POST /api/auth/register
      â†“
Backend Validation (express-validator)
      â†“
Check if user exists (MongoDB query)
      â†“
Password Hashing (bcrypt)
      â†“
Save to MongoDB (users collection)
      â†“
Generate JWT Token
      â†“
Return token + user data
      â†“
Store in LocalStorage
      â†“
Redirect to Dashboard
```

### 2. Manual Feeding Flow

```
User clicks "Feed" button
      â†“
Select portion size (small/medium/large)
      â†“
POST /api/feeding/activate
      â†“
Verify JWT Token
      â†“
Calculate servo angle:
  - small = 45Â°
  - medium = 90Â°
  - large = 135Â°
      â†“
Create FeedingLog document
      â†“
Publish MQTT message:
  {
    action: "dispense",
    angle: 90,
    duration: 2000
  }
      â†“
MQTT Broker forwards to ESP32
      â†“
ESP32 receives command
      â†“
Servo motor rotates to angle
      â†“
Wait for duration (2 seconds)
      â†“
Return servo to 0Â° (closed)
      â†“
ESP32 publishes response
      â†“
Backend updates log status
      â†“
Frontend displays "Success!"
```

### 3. Scheduled Feeding Flow

```
Cron Job (runs every minute)
      â†“
Get current time (HH:MM)
      â†“
Query active schedules matching time
      â†“
Check if already triggered today
      â†“
For each matching schedule:
  â†“
  Create FeedingLog
  â†“
  Publish MQTT command
  â†“
  Update schedule.lastTriggered
  â†“
  Mark as triggered
      â†“
At midnight (00:00):
  Clear triggered schedules map
  Allow schedules to trigger again
```

---

## ğŸ—„ï¸ Database Entity Relationship

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸ‘¤ USER          â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ _id: ObjectId (PK)      â”‚
â”‚ username: String        â”‚
â”‚ email: String (unique)  â”‚
â”‚ password: String (hash) â”‚
â”‚ petName: String         â”‚
â”‚ createdAt: Date         â”‚
â”‚ updatedAt: Date         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 1:N (one user has many schedules)
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“… FEEDING_SCHEDULE      â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ _id: ObjectId (PK)         â”‚
â”‚ userId: ObjectId (FK) â”€â”€â”€â”€â”â”‚
â”‚ feedingTime: String        â”‚â”‚
â”‚ portionSize: Enum          â”‚â”‚
â”‚ isActive: Boolean          â”‚â”‚
â”‚ repeatDaily: Boolean       â”‚â”‚
â”‚ lastTriggered: Date        â”‚â”‚
â”‚ createdAt: Date            â”‚â”‚
â”‚ updatedAt: Date            â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
             â”‚                 â”‚
             â”‚ 1:N             â”‚
             â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    ğŸ“Š FEEDING_LOG        â”‚  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚ _id: ObjectId (PK)       â”‚  â”‚
â”‚ userId: ObjectId (FK) â”€â”€â”€â”¼â”€â”€â”˜
â”‚ scheduleId: ObjectId (FK)â”‚â—„â”€â”€â”€â”˜
â”‚ action: String           â”‚
â”‚ status: Enum             â”‚
â”‚ portionSize: String      â”‚
â”‚ servoAngle: Number       â”‚
â”‚ triggerType: Enum        â”‚
â”‚ timestamp: Date          â”‚
â”‚ createdAt: Date          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Circuit Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ESP32 / ARDUINO                     â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚          Microcontroller Pins            â”‚       â”‚
â”‚  â”‚                                          â”‚       â”‚
â”‚  â”‚  GPIO 18 (ESP32)  â—‹                     â”‚       â”‚
â”‚  â”‚  Pin 9 (Arduino)  â”‚                     â”‚       â”‚
â”‚  â”‚                   â”‚                     â”‚       â”‚
â”‚  â”‚  5V Power         â—‹                     â”‚       â”‚
â”‚  â”‚                   â”‚                     â”‚       â”‚
â”‚  â”‚  GND              â—‹                     â”‚       â”‚
â”‚  â”‚                   â”‚                     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                      â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  â”‚                  â”‚
    â”‚ Signal (Orange)  â”‚                  â”‚
    â”‚         â—‹â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
    â”‚                                     â”‚
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚         â”‚               â”‚           â”‚
    â”‚         â”‚  SERVO MOTOR  â”‚           â”‚
    â”‚         â”‚    (SG90)     â”‚           â”‚
    â”‚         â”‚               â”‚           â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                     â”‚
    â”‚ VCC (Red)      â—‹â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚                       â”‚             â”‚
    â”‚ GND (Brown)    â—‹â”€â”€â”€â”€â”€â”€â”¤             â”‚
    â”‚                       â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   5V Power    â”‚
                    â”‚   Supply      â”‚
                    â”‚   (>500mA)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Connections:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Servo Signal  â†’  ESP32 GPIO 18 (or Arduino Pin 9)
2. Servo VCC     â†’  5V Power Supply
3. Servo GND     â†’  Common Ground
4. ESP32 GND     â†’  Common Ground
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ IMPORTANT:
- Servo motor requires 5V with 500mA+ current
- USB power might not be sufficient
- Use external 5V power supply for stable operation
- Ensure common ground between ESP32/Arduino and servo
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SECURITY LAYERS                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Frontend Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ Input Validation                                 â”‚
â”‚  âœ“ XSS Prevention (React auto-escaping)            â”‚
â”‚  âœ“ Token Storage (LocalStorage)                    â”‚
â”‚  âœ“ Automatic token injection (Axios)               â”‚
â”‚  âœ“ Route Protection (ProtectedRoute)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
Layer 2: Transport Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ HTTPS (Production)                               â”‚
â”‚  âœ“ Bearer Token Authorization                       â”‚
â”‚  âœ“ CORS Configuration                               â”‚
â”‚  âœ“ HTTP-only cookies (optional)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
Layer 3: Backend Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ JWT Verification (7-day expiry)                  â”‚
â”‚  âœ“ express-validator (input sanitization)          â”‚
â”‚  âœ“ Middleware authentication                        â”‚
â”‚  âœ“ Password hashing (bcrypt, 10 rounds)            â”‚
â”‚  âœ“ Error message sanitization                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
Layer 4: Database Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ MongoDB Atlas encryption (TLS/SSL)              â”‚
â”‚  âœ“ IP Whitelisting                                 â”‚
â”‚  âœ“ Database authentication                         â”‚
â”‚  âœ“ Mongoose query sanitization                     â”‚
â”‚  âœ“ Environment variables (.env)                    â”‚
â”‚  âœ“ No sensitive data in logs                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Component Hierarchy

```
App.jsx (Root)
â”‚
â”œâ”€â”€â”€ Router (React Router DOM)
â”‚    â”‚
â”‚    â”œâ”€â”€â”€ Route: "/" â†’ Navigate to /login or /dashboard
â”‚    â”‚
â”‚    â”œâ”€â”€â”€ Route: "/login"
â”‚    â”‚    â””â”€â”€â”€ Login.jsx
â”‚    â”‚         â”œâ”€â”€â”€ Login Form
â”‚    â”‚         â”œâ”€â”€â”€ Email Input
â”‚    â”‚         â”œâ”€â”€â”€ Password Input
â”‚    â”‚         â”œâ”€â”€â”€ Submit Button
â”‚    â”‚         â””â”€â”€â”€ Link to Register
â”‚    â”‚
â”‚    â”œâ”€â”€â”€ Route: "/register"
â”‚    â”‚    â””â”€â”€â”€ Register.jsx
â”‚    â”‚         â”œâ”€â”€â”€ Registration Form
â”‚    â”‚         â”œâ”€â”€â”€ Username Input
â”‚    â”‚         â”œâ”€â”€â”€ Email Input
â”‚    â”‚         â”œâ”€â”€â”€ Pet Name Input
â”‚    â”‚         â”œâ”€â”€â”€ Password Input
â”‚    â”‚         â”œâ”€â”€â”€ Confirm Password Input
â”‚    â”‚         â”œâ”€â”€â”€ Submit Button
â”‚    â”‚         â””â”€â”€â”€ Link to Login
â”‚    â”‚
â”‚    â””â”€â”€â”€ Route: "/dashboard" (Protected)
â”‚         â””â”€â”€â”€ Dashboard.jsx
â”‚              â”‚
â”‚              â”œâ”€â”€â”€ Header
â”‚              â”‚    â”œâ”€â”€â”€ Logo & Title
â”‚              â”‚    â”œâ”€â”€â”€ User Info
â”‚              â”‚    â””â”€â”€â”€ Logout Button
â”‚              â”‚
â”‚              â”œâ”€â”€â”€ Status Bar
â”‚              â”‚    â”œâ”€â”€â”€ System Status
â”‚              â”‚    â”œâ”€â”€â”€ Active Schedules
â”‚              â”‚    â””â”€â”€â”€ Current Time
â”‚              â”‚
â”‚              â”œâ”€â”€â”€ Tabs
â”‚              â”‚    â”œâ”€â”€â”€ Control Tab
â”‚              â”‚    â”œâ”€â”€â”€ Schedule Tab
â”‚              â”‚    â””â”€â”€â”€ History Tab
â”‚              â”‚
â”‚              â””â”€â”€â”€ Content Area
â”‚                   â”‚
â”‚                   â”œâ”€â”€â”€ Control Tab Content
â”‚                   â”‚    â”œâ”€â”€â”€ Portion Buttons (S/M/L)
â”‚                   â”‚    â”œâ”€â”€â”€ Emergency Stop
â”‚                   â”‚    â””â”€â”€â”€ Status Display
â”‚                   â”‚
â”‚                   â”œâ”€â”€â”€ Schedule Tab Content
â”‚                   â”‚    â”œâ”€â”€â”€ Create Schedule Form
â”‚                   â”‚    â””â”€â”€â”€ Schedule List
â”‚                   â”‚         â””â”€â”€â”€ Schedule Items
â”‚                   â”‚              â”œâ”€â”€â”€ Time Display
â”‚                   â”‚              â”œâ”€â”€â”€ Portion Size
â”‚                   â”‚              â”œâ”€â”€â”€ Active Status
â”‚                   â”‚              â””â”€â”€â”€ Action Buttons
â”‚                   â”‚
â”‚                   â””â”€â”€â”€ History Tab Content
â”‚                        â””â”€â”€â”€ Logs Table
â”‚                             â””â”€â”€â”€ Log Rows
â”‚                                  â”œâ”€â”€â”€ Timestamp
â”‚                                  â”œâ”€â”€â”€ Action
â”‚                                  â”œâ”€â”€â”€ Portion
â”‚                                  â””â”€â”€â”€ Status Badge
```

---

## ğŸ”„ State Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           REACT COMPONENT STATE                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Dashboard.jsx State:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  const [user, setUser] = useState(null)         â”‚ â† From LocalStorage
â”‚  const [schedules, setSchedules] = useState([]) â”‚ â† From API
â”‚  const [logs, setLogs] = useState([])           â”‚ â† From API
â”‚  const [status, setStatus] = useState(null)     â”‚ â† From API
â”‚  const [loading, setLoading] = useState(false)  â”‚ â† UI state
â”‚  const [activeTab, setActiveTab] = useState()   â”‚ â† UI state
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

State Update Flow:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                  â”‚
â”‚  User Action (button click)                     â”‚
â”‚         â†“                                        â”‚
â”‚  Update UI state (setLoading(true))             â”‚
â”‚         â†“                                        â”‚
â”‚  API Call (axios)                                â”‚
â”‚         â†“                                        â”‚
â”‚  Backend Processing                              â”‚
â”‚         â†“                                        â”‚
â”‚  Response received                               â”‚
â”‚         â†“                                        â”‚
â”‚  Update component state (setSchedules)           â”‚
â”‚         â†“                                        â”‚
â”‚  Re-render UI with new data                     â”‚
â”‚         â†“                                        â”‚
â”‚  Update UI state (setLoading(false))            â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š MQTT Message Structure

### Command Message (Backend â†’ ESP32)

```json
Topic: petfeeder/servo

Payload:
{
  "action": "dispense",
  "angle": 90,
  "duration": 2000,
  "scheduleId": "6765abc123def456",
  "logId": "6765def789abc012"
}

Fields:
- action: "dispense" | "stop"
- angle: 0-180 degrees
- duration: milliseconds
- scheduleId: MongoDB ObjectId (optional)
- logId: MongoDB ObjectId (for tracking)
```

### Response Message (ESP32 â†’ Backend)

```json
Topic: petfeeder/servo/response

Payload:
{
  "event": "feeding_complete",
  "status": "success",
  "timestamp": 1234567890
}

Fields:
- event: "feeding_started" | "feeding_complete" | "feeding_stopped"
- status: "success" | "failed" | "in-progress"
- timestamp: milliseconds since boot
- error: (optional) error message if failed
```

---

## ğŸ¯ API Response Structure

### Success Response

```json
{
  "success": true,
  "message": "Operation successful",
  "data": {
    // Response payload
  }
}
```

### Error Response

```json
{
  "success": false,
  "message": "Error description",
  "errors": [
    {
      "field": "email",
      "message": "Invalid email format"
    }
  ]
}
```

---

**ğŸ¨ These diagrams provide a comprehensive visual understanding of the entire system!**

**Use these for:**

- ğŸ“Š Project presentations
- ğŸ“š Documentation
- ğŸ“ Academic submissions
- ğŸ’¼ Portfolio showcases
- ğŸ—£ï¸ Technical interviews

---

_Last Updated: December 2025_
